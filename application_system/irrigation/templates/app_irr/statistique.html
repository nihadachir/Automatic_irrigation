
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Required meta tags -->
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <!--FontAwesome CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
        integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">

    <!--Chartjs CDN-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>

    <!--Custome CSS-->
    
    
    <title>Statistiques</title>

    
   
</head>
<body >
 
   

    {% include 'navbar.html'%}
    <div class="container-bg-dark">
        
        <div class="container">
            <div class="row my-5">
    <div class="card mx-2 bg-primary" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title text-white"><i class='bx bx-calendar'></i> Date de Début</h5>
                           
          <p class="card-text text-white">{{ min_date }}</p>
         
        </div>
      </div>
      
    {% for t in terre %}
    {% if t.arrosage == False %} 
      <div class="card mx-3 bg-warning" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title text-white"><i class='bx bx-calendar'></i> Date de Fin</h5>
                           
          <p class="card-text text-white">{{ max_date }}</p>
         
        </div>
      </div>
    {% else %}
    <div class="card mx-4 bg-danger" style="width: 18rem;">
        <div class="card-body text-white">
          <h5 class="card-title text-white"><i class='bx bx-time-five'></i> Débit total</h5>
                           
          <p class="card-text">{{debit_totale}}</p>
         
        </div>
      </div>
    {% endif %}
    {% endfor %}
      <div class="card mx-4 bg-success" style="width: 18rem;">
        <div class="card-body text-white">
          <h5 class="card-title text-white"><i class='bx bx-time-five'></i> Durée</h5>
                           
          <p class="card-text">{{ duree_irrigation}}</p>
         
        </div>
      </div>
      
      

      <h1> {{ erreur }}</h1>
    
   
    <br>   <div class="col-md-6 ">
        <div class="bg-black">
         <div class="card-body">
            <canvas id="myChart9"></canvas>

            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script>
              var data = {{ data1|safe }};
          
              var ctx = document.getElementById('myChart9').getContext('2d');
              var myChart = new Chart(ctx, {
                type: 'bar', 
                data: {
                  datasets: [{
                    label: 'Consommation d\'eau par semaine',
                    data: data.semaine,
                    backgroundColor: 'blue',
                    fill: false
                  }, {
                    label: 'Consommation d\'eau par mois',
                    data: data.mois,
                    backgroundColor: 'green',
                    fill: false
                  }, {
                    label: 'Consommation d\'eau par semestre',
                    data: data.semestre,
                    backgroundColor: 'red',
                    fill: false
                  }, {
                    label: 'Consommation d\'eau par an',
                    data: data.annee,
                    backgroundColor: 'purple',
                    fill: false
                  }, {
                    label: 'Consommation d\'eau des 5 dernières années',
                    data: data.cinq_ans,
                    backgroundColor: 'orange',
                    fill: false
                  }]
                },
                options: {
                  scales: {
                    xAxes: [{
                      type: 'time',
                      time: {
                        unit: 'week'
                      },
                      scaleLabel: {
                        display: true,
                        labelString: 'Date'
                      }
                    }],
                    yAxes: [{
                      ticks: {
                        beginAtZero: true
                      },
                      scaleLabel: {
                        display: true,
                        labelString: 'Consommation d\'eau (L)'
                      }
                    }]
                  }
                }
              });
            </script>
          
         </div> 
        </div>
    </div>
   
   
              
                <div class="col-md-6 ">
                    <div class="bg-black">
                     <div class="card-body">
                       
                        <canvas id="myChart" ></canvas>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                        var ctx = document.getElementById('myChart');
                        var myChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: {{ dt|safe }},
                                datasets: [{
                                    label: 'Température',
                                    data: {{ labels|safe }},
                                    backgroundColor: 'rgb(255, 64, 0)',
                                    borderColor: 'rgb(255, 64, 0)',
                                    borderWidth: 2
                                }],
                                
                            },
                            options: {
                                
                                scales: {
                                    xAxes: [{
                                        type: 'time',
                                        time: {
                                            unit:'day',
                                            displayFormats: {
                                                day: 'MMM DD'
                                            },
                                            
                                        },
                                                                 
                                    }],
                                    yAxes: [{
                                        ticks: {
                                            beginAtZero: true
                                        }
                                    }]
                                }
                            }
                        });
                        </script>
                     </div> 
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="bg-black">
                        <div class="card-body">
                        <canvas id="myChart1" ></canvas>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                        var ctx = document.getElementById('myChart1');
                        var myChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: {{ dt|safe }},
                                datasets: [{
                                    label: 'Humidité',
                                    data: {{ humidite|safe }},
                                    backgroundColor: 'rgb(179, 119, 0)',
                                    borderColor: 'rgba(0,0,0,0)',
                                    borderWidth: 2,
                                    pointRadius: 8,
                                    pointStyle: 'circle'
   
                                }],
                                
                            },
                            options: {
                                
                                responsive: true,
                                 
                                scales: {
                                    xAxes: [{
                                        type: 'time',
                                        time: {
                                            unit:'day',
                                            displayFormats: {
                                                day: 'MMM DD'
                                            },
                                            
                                        },
                                      
                                                                 
                                    }],
                                    yAxes: [{
                                        
                
                                        ticks: {
                                            beginAtZero: true,

                                        }
                                    }]
                                }
                            }
                        });
                        </script>
                        </div>
                    </div>
                </div>
    
                <div class="col-md-6">
                    <div class="bg-black">
                        <div class="card-body">
                        <canvas id="myChart2" ></canvas>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                        var ctx = document.getElementById('myChart2');
                        var myChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: {{ dt|safe }},
                                datasets: [{
                                    label: 'Humidité de sol',
                                    data: {{ HS|safe }},
                                    backgroundColor: '#b35900',
                                    borderColor: '#b35900',
                                    borderWidth: 3
                                }],
                                
                            },
                            options: {
                                
                                scales: {
                                    xAxes: [{
                                        type: 'time',
                                        time: {
                                            unit:'day',
                                            displayFormats: {
                                                day: 'MMM DD'
                                            },
                                            
                                        },
                                                                 
                                    }],
                                    yAxes: [{
                                        ticks: {
                                            beginAtZero: true
                                        }
                                    }]
                                }
                            }
                        });
                        </script>
                        </div>
                    </div>
                </div>
    
                <div class="col-md-6">
                    <div class="bg-black">
                        <div class="card-body">
                        <canvas id="myChart3" ></canvas>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                        var ctx = document.getElementById('myChart3');
                        var myChart = new Chart(ctx, {
                         type: 'line',
                         data: {
                        labels: {{ dt|safe }},
                         datasets: [{
                         label: 'Force de vent',
                         data: {{ FV|safe }},
                         backgroundColor: 'lightblue',
                         borderColor: 'rgb(0, 153, 153)',
                         borderWidth: 3
                          }]
                        },
                        options: {
                          scales: {
                          xAxes: [{
                          type: 'time',
                          time: {
                          unit:'day',
                         displayFormats: {
                           day: 'MMM DD'
                         }
                         }
                         }],
                         yAxes: [{
                          ticks: {
                           beginAtZero: true
                             }
                              }]
                             },
                           legend: {
                           labels: {
                            fontColor: 'white' // Couleur du texte de légende
                                }
                             },
                             title: {
                            fontColor: 'white' // Couleur du texte du titre
                              },
                                tooltips: {
                                   callbacks: {
                                     label: function(tooltipItem, data) {
                                         return data.datasets[tooltipItem.datasetIndex].label + ': ' + tooltipItem.yLabel; // Couleur du texte de la bulle d'information
                                    }
                                  }
                                }
                            }
                       });
                        </script>
                        </div>
                    </div>
                </div>
               <br>
                <div class="col-md-6 mx-auto">
                    <div class="bg-black">
                        <div class="card-body">

                        <canvas id="myChart4" ></canvas>
                        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                        <script>
                        var ctx = document.getElementById('myChart4');
                        var myChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: {{ dt|safe }},
                                datasets: [{
                                    label: 'Rayonnement Solaire',
                                    data: {{ RS|safe }},
                                    backgroundColor: 'orange',
                                    borderColor: 'orange',
                                    borderWidth: 3,
                                    pointRadius: 4,

                                    
                                    
                                }],
                                
                            },
                            options: {
                                
                                scales: {
                                    xAxes: [{
                                        type: 'time',
                                        time: {
                                            unit:'day',
                                            displayFormats: {
                                                day: 'MMM DD'
                                            },
                                            
                                        },
                                                                 
                                    }],
                                    yAxes: [{
                                        ticks: {
                                            beginAtZero: true
                                        }
                                    }]
                                }
                            }
                        });
                        </script>
                        </div>
                    </div>
                </div>
            
              
    
            </div> 
        </div>
        <div class="row">
            <div class="col-sm-12 mt-2">
                
            {% for t in terre %}
            {% if t.arrosage == True %}    
                 

                <span  > Vos Statistiques </span> 
                <a class="btn btn-success btn-sm float-right" 
                                href="{% url 'statistique_create' %}?terid={{t.id}}">Ajouter statistique</a><br><br>
            {% endif %}   
            {% endfor %} 
                <table class="table  table-sm ">
                    <thead >
                        <tr>
                            <th>Température</th>
                            <th>Date</th>
                            <th>Heure</th>
                            <th>Humidité</th>
                            <th>Humidité_Sol</th>
                            <th>Force_de_Vent</th>
                            <th>Rayonnement_Solaire</th>
                            <th>Débit</th>
                            <th>Consommation_d'eau</th>
                            <th>Opération</th>
                            </tr>
                        </tr>
                    </thead>
                    <tbody>
                        {% for s in statistique %}
                            <tr>                  
                            <td>{{s.temperature}}</td>
                            <td>{{s.date}}</td>
                            <td>{{s.heure}}</td>
                            <td>{{s.humidite}}</td>
                            <td>{{s.HS}}</td>
                            <td>{{s.FV}}</td>
                            <td>{{s.RS}}</td>
                            <td>{{s.debit}}</td>
                            <td>{{s.consommation_eau}}</td>
                            <td>
                            <a href="{% url 'statistique_update' %}?sid={{s.id}}" class="btn btn-success btn-sm"><i class="fa fa-edit"></i></a>
                            <a href="{% url 'statistique_delete' %}?sid={{s.id}}" class="btn btn-success btn-sm"><i class="fa fa-trash"></i></a>
                            </td>
                            </tr>
                        {% endfor %} 
                    </tbody>
                </table>
            </div>
        </div>
    </div>
   
                
                   
               

             
</body>
</html>
   

